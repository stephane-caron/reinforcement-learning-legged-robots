% Inspired by the BrownU Theme for Metropolis (License: MIT)
% https://github.com/vskbellala/metropolis-brown

\RequirePackage{caption}

\usetheme[progressbar=frametitle]{metropolis}
\metroset{titleformat frame=allsmallcaps}
\metroset{block=fill}
\metroset{sectionpage=progressbar}
\usefonttheme{professionalfonts}
\setmonofont{FiraMono-Regular.otf}  % https://tex.stackexchange.com/q/545073

% Constants
\definecolor{cAlertRed}{RGB}{237, 28, 36}
\definecolor{cDarkGold}{RGB}{224, 165, 0}
\definecolor{cInriaRed}{HTML}{dd212c}
\definecolor{cInriaOrange}{HTML}{ef681f}
\definecolor{cDarkRed}{HTML}{5c3333}
\newcommand{\progressbar}{1pt}

% Captions
\captionsetup[figure]{labelfont={bf,color=cInriaRed}}
\captionsetup[table]{labelfont={bf,color=cInriaRed}}

% Progress Bar
\makeatletter
\setlength{\metropolis@titleseparator@linewidth}{\progressbar}
\setlength{\metropolis@progressonsectionpage@linewidth}{\progressbar}
\setlength{\metropolis@progressinheadfoot@linewidth}{\progressbar}
\makeatother

% Slide colors
\setbeamercolor{alerted text}{fg=cAlertRed}
\setbeamercolor{example text}{fg=cDarkGold}
\setbeamercolor{palette primary}{bg=cInriaRed}
\setbeamercolor{bibliography entry location}{fg=cInriaRed}

\setbeamercolor{frametitle}{%
  use=palette primary,
  parent=palette primary
}

% The following commands fix theme switches
% See https://tex.stackexchange.com/a/329454
\makeatletter
\renewcommand{\metropolis@colors@dark}{%
    \setbeamercolor{normal text}{fg=black!2, bg=cInriaRed}%
    \usebeamercolor[fg]{normal text}}
\renewcommand{\metropolis@colors@light}{%
    \setbeamercolor{normal text}{fg=mDarkTeal, bg=black!2}%
    \usebeamercolor[fg]{normal text}}
\makeatother

\newcommand{\highlight}[1]{{\color{cInriaOrange} \textbf{#1}}}

\setbeamertemplate{frame footer}{\insertshorttitle}
\setbeamerfont{page number in head/foot}{size=\tiny}
\setbeamercolor{footline}{fg=gray}

% Bibliography

\setbeamertemplate{bibliography item}{\insertbiblabel}
\setbeamerfont{bibliography entry author}{size=\footnotesize}
\setbeamerfont{bibliography entry title}{size=\footnotesize}
\setbeamerfont{bibliography entry location}{size=\footnotesize}
\setbeamerfont{bibliography entry note}{size=\footnotesize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Syntax highlighting
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\RequirePackage{minted}

\definecolor{codebg}{rgb}{0.95, 0.955, 0.96}

\setminted[bash]{
    autogobble,
    bgcolor=codebg,
    fontsize=\footnotesize,
    framesep=50mm,
    xleftmargin=1em,
    xrightmargin=1em,
}

\setminted[python]{
    autogobble,
    bgcolor=codebg,
    fontsize=\footnotesize,
    framesep=50mm,
    xleftmargin=0.5em,
    xrightmargin=0.5em,
}
